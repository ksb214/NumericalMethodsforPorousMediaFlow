      SUBROUTINE DRANCHUK(TR,PR,IREPEAT,Z)
      IMPLICIT REAL*8 (A-H,O-Z)
C     TR    IS THE PSEUDO-REDUCED TEMPERATURE
C     PR    IS THE PSEUDO-REDUCED PRESSU.RE
C     Z     IS THE GAS COMPRESSIBILITY FACTOR
C     DR    IS THE REDUCED DENSITY OF GAS
C     IREPEAT  IS AN IREPEATATION FLAG
C       IREPEAT=0 EITHER OR BOTH TR AND PR ARE
C                OUTSIDE RANGE OF CORRELATION
C       IREPEAT>0 NUMBER OF IREPEATATIONS
      DIMENSION A(11)
      DATA A/0.3265,-1.070,-0.5339,0.01569,-0.05165,
     *  0.5475,-0.7361,0.1844,0.1056,0.6134,0.7210/
      IREPEAT=0
      J=1
      DR=1.0D0
      TR2=TR**2.0D0
      TR3=TR**3.0D0
      TR4=TR**4.0D0
      C1=A(7)+A(8)/TR
      C0=A(1)*TR+A(2)+A(3)/TR2+A(4)/TR3+A(5)/TR4
      C2=A(6)*TR+C1
      C3=-C1*A(9)
      C4=A(10)/TR2
      IF(PR-30.0D0)1,1,18
    1 IF(TR-1.0D0) 2,2,3
    2 J=0
      DR=0.0D0
      DELDR=0.1D0
    3 IF(TR-3.0D0) 4,4,18
    4 DO 16 IREPEAT=1,100
      IF(J) 5,5,6
    5 DR1=DR
      DR=DR+DELDR
    6 DR2=DR**2.0D0
      DR5=DR**5.0D0
      T1=C0*DR
      T2=C2*DR2
      T3=C3*DR5
      T4=C4*DR2
      T5=A(11)*DR2
      T6=DEXP(-T5)
      P=(TR+T1+T2+T3)*DR+T4*DR*(1.0D0+T5)*T6
      DP=TR+2.0D0*T1+3.0D0*T2+6.0D0*T3+
     *   T4*T6*(3.0D0+3.0D0*T5-2.0D0*T5*T5)
      IF(J) 7,7,10
    7 PRCAL=P/0.27D0
      IF(DABS(PRCAL-PR)-0.1D-02) 17,17,8
    8 IF(PRCAL-PR)  16,17,9
    9 DR=DR1
      DELDR=DELDR/2.0D0
      GO TO 16
   10 DR1=DR-(P-0.270D0*PR)/DP
      IF(DR1) 11,11,12
   11 DR1=0.5D0*DR
   12 IF(DR1-2.2D0) 14,14,13
   13 DR1=DR+0.9D0*(2.2D0-DR)
   14 IF (DABS(DR-DR1)-0.1D-04) 17,15,15
   15 DR=DR1
   16 CONTINUE
   17 Z=0.270D0*PR/(DR*TR)
   18 RETURN
      END